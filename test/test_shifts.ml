open Base
open Import
module I = Ocaml_intrinsics_kernel

let numbers = [ 0; 1; 5; 7; -1; -3 ]
let shifts = [ 0; 1; 2; 3; 4; 31; 32; 33; 62; 63; 64; 65; 66; -1; -3 ]

module%test Int64 = struct
  open Int64

  let numbers = List.map ~f:of_int numbers @ [ max_value; min_value ]
  let shifts = List.map ~f:of_int shifts @ [ max_value; min_value ]

  let test ~op ~expected_op ~name =
    let f ~shift x =
      test_shifts (module Int64.Binary) (module Int64) ~op ~expected_op ~name x shift
    in
    List.iter shifts ~f:(fun shift ->
      let f = f ~shift in
      List.iter ~f numbers)
  ;;

  let%expect_test "shift_left int64" =
    test
      ~op:I.Int64.shift_left
      ~expected_op:I.Int64.Naive.shift_left
      ~name:"Int64.shift_left";
    [%expect
      {|
      0b0 Int64.shift_left by 0 =
      0b0
      0b1 Int64.shift_left by 0 =
      0b1
      0b101 Int64.shift_left by 0 =
      0b101
      0b111 Int64.shift_left by 0 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by 0 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_left by 0 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by 0 =
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_left by 0 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Int64.shift_left by 1 =
      0b0
      0b1 Int64.shift_left by 1 =
      0b10
      0b101 Int64.shift_left by 1 =
      0b1010
      0b111 Int64.shift_left by 1 =
      0b1110
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by 1 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1110
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_left by 1 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1010
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by 1 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1110
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_left by 1 =
      0b0
      0b0 Int64.shift_left by 2 =
      0b0
      0b1 Int64.shift_left by 2 =
      0b100
      0b101 Int64.shift_left by 2 =
      0b1_0100
      0b111 Int64.shift_left by 2 =
      0b1_1100
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by 2 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1100
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_left by 2 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_0100
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by 2 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1100
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_left by 2 =
      0b0
      0b0 Int64.shift_left by 3 =
      0b0
      0b1 Int64.shift_left by 3 =
      0b1000
      0b101 Int64.shift_left by 3 =
      0b10_1000
      0b111 Int64.shift_left by 3 =
      0b11_1000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by 3 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_left by 3 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1110_1000
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by 3 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1000
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_left by 3 =
      0b0
      0b0 Int64.shift_left by 4 =
      0b0
      0b1 Int64.shift_left by 4 =
      0b1_0000
      0b101 Int64.shift_left by 4 =
      0b101_0000
      0b111 Int64.shift_left by 4 =
      0b111_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by 4 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_left by 4 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101_0000
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by 4 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_0000
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_left by 4 =
      0b0
      0b0 Int64.shift_left by 31 =
      0b0
      0b1 Int64.shift_left by 31 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b101 Int64.shift_left by 31 =
      0b10_1000_0000_0000_0000_0000_0000_0000_0000
      0b111 Int64.shift_left by 31 =
      0b11_1000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by 31 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_left by 31 =
      0b1111_1111_1111_1111_1111_1111_1111_1110_1000_0000_0000_0000_0000_0000_0000_0000
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by 31 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1000_0000_0000_0000_0000_0000_0000_0000
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_left by 31 =
      0b0
      0b0 Int64.shift_left by 32 =
      0b0
      0b1 Int64.shift_left by 32 =
      0b1_0000_0000_0000_0000_0000_0000_0000_0000
      0b101 Int64.shift_left by 32 =
      0b101_0000_0000_0000_0000_0000_0000_0000_0000
      0b111 Int64.shift_left by 32 =
      0b111_0000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by 32 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_0000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_left by 32 =
      0b1111_1111_1111_1111_1111_1111_1111_1101_0000_0000_0000_0000_0000_0000_0000_0000
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by 32 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_0000_0000_0000_0000_0000_0000_0000_0000
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_left by 32 =
      0b0
      0b0 Int64.shift_left by 33 =
      0b0
      0b1 Int64.shift_left by 33 =
      0b10_0000_0000_0000_0000_0000_0000_0000_0000
      0b101 Int64.shift_left by 33 =
      0b1010_0000_0000_0000_0000_0000_0000_0000_0000
      0b111 Int64.shift_left by 33 =
      0b1110_0000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by 33 =
      0b1111_1111_1111_1111_1111_1111_1111_1110_0000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_left by 33 =
      0b1111_1111_1111_1111_1111_1111_1111_1010_0000_0000_0000_0000_0000_0000_0000_0000
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by 33 =
      0b1111_1111_1111_1111_1111_1111_1111_1110_0000_0000_0000_0000_0000_0000_0000_0000
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_left by 33 =
      0b0
      0b0 Int64.shift_left by 62 =
      0b0
      0b1 Int64.shift_left by 62 =
      0b100_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b101 Int64.shift_left by 62 =
      0b100_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b111 Int64.shift_left by 62 =
      0b1100_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by 62 =
      0b1100_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_left by 62 =
      0b100_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by 62 =
      0b1100_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_left by 62 =
      0b0
      0b0 Int64.shift_left by 63 =
      0b0
      0b1 Int64.shift_left by 63 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b101 Int64.shift_left by 63 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b111 Int64.shift_left by 63 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by 63 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_left by 63 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by 63 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_left by 63 =
      0b0
      0b0 Int64.shift_left by 64 =
      0b0
      0b1 Int64.shift_left by 64 =
      0b1
      0b101 Int64.shift_left by 64 =
      0b101
      0b111 Int64.shift_left by 64 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by 64 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_left by 64 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by 64 =
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_left by 64 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Int64.shift_left by 65 =
      0b0
      0b1 Int64.shift_left by 65 =
      0b10
      0b101 Int64.shift_left by 65 =
      0b1010
      0b111 Int64.shift_left by 65 =
      0b1110
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by 65 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1110
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_left by 65 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1010
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by 65 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1110
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_left by 65 =
      0b0
      0b0 Int64.shift_left by 66 =
      0b0
      0b1 Int64.shift_left by 66 =
      0b100
      0b101 Int64.shift_left by 66 =
      0b1_0100
      0b111 Int64.shift_left by 66 =
      0b1_1100
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by 66 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1100
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_left by 66 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_0100
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by 66 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1100
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_left by 66 =
      0b0
      0b0 Int64.shift_left by -1 =
      0b0
      0b1 Int64.shift_left by -1 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b101 Int64.shift_left by -1 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b111 Int64.shift_left by -1 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by -1 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_left by -1 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by -1 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_left by -1 =
      0b0
      0b0 Int64.shift_left by -3 =
      0b0
      0b1 Int64.shift_left by -3 =
      0b10_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b101 Int64.shift_left by -3 =
      0b1010_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b111 Int64.shift_left by -3 =
      0b1110_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by -3 =
      0b1110_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_left by -3 =
      0b1010_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by -3 =
      0b1110_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_left by -3 =
      0b0
      0b0 Int64.shift_left by 9_223_372_036_854_775_807 =
      0b0
      0b1 Int64.shift_left by 9_223_372_036_854_775_807 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b101 Int64.shift_left by 9_223_372_036_854_775_807 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b111 Int64.shift_left by 9_223_372_036_854_775_807 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by 9_223_372_036_854_775_807 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_left by 9_223_372_036_854_775_807 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by 9_223_372_036_854_775_807 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_left by 9_223_372_036_854_775_807 =
      0b0
      0b0 Int64.shift_left by -9_223_372_036_854_775_808 =
      0b0
      0b1 Int64.shift_left by -9_223_372_036_854_775_808 =
      0b1
      0b101 Int64.shift_left by -9_223_372_036_854_775_808 =
      0b101
      0b111 Int64.shift_left by -9_223_372_036_854_775_808 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by -9_223_372_036_854_775_808 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_left by -9_223_372_036_854_775_808 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_left by -9_223_372_036_854_775_808 =
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_left by -9_223_372_036_854_775_808 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      |}];
    ()
  ;;

  let%expect_test "shift_right int64" =
    test
      ~op:I.Int64.shift_right
      ~expected_op:I.Int64.Naive.shift_right
      ~name:"Int64.shift_right";
    [%expect
      {|
      0b0 Int64.shift_right by 0 =
      0b0
      0b1 Int64.shift_right by 0 =
      0b1
      0b101 Int64.shift_right by 0 =
      0b101
      0b111 Int64.shift_right by 0 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by 0 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right by 0 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by 0 =
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right by 0 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Int64.shift_right by 1 =
      0b0
      0b1 Int64.shift_right by 1 =
      0b0
      0b101 Int64.shift_right by 1 =
      0b10
      0b111 Int64.shift_right by 1 =
      0b11
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by 1 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right by 1 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1110
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by 1 =
      0b11_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right by 1 =
      0b1100_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Int64.shift_right by 2 =
      0b0
      0b1 Int64.shift_right by 2 =
      0b0
      0b101 Int64.shift_right by 2 =
      0b1
      0b111 Int64.shift_right by 2 =
      0b1
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by 2 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right by 2 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by 2 =
      0b1_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right by 2 =
      0b1110_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Int64.shift_right by 3 =
      0b0
      0b1 Int64.shift_right by 3 =
      0b0
      0b101 Int64.shift_right by 3 =
      0b0
      0b111 Int64.shift_right by 3 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by 3 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right by 3 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by 3 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right by 3 =
      0b1111_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Int64.shift_right by 4 =
      0b0
      0b1 Int64.shift_right by 4 =
      0b0
      0b101 Int64.shift_right by 4 =
      0b0
      0b111 Int64.shift_right by 4 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by 4 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right by 4 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by 4 =
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right by 4 =
      0b1111_1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Int64.shift_right by 31 =
      0b0
      0b1 Int64.shift_right by 31 =
      0b0
      0b101 Int64.shift_right by 31 =
      0b0
      0b111 Int64.shift_right by 31 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by 31 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right by 31 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by 31 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right by 31 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Int64.shift_right by 32 =
      0b0
      0b1 Int64.shift_right by 32 =
      0b0
      0b101 Int64.shift_right by 32 =
      0b0
      0b111 Int64.shift_right by 32 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by 32 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right by 32 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by 32 =
      0b111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right by 32 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1000_0000_0000_0000_0000_0000_0000_0000
      0b0 Int64.shift_right by 33 =
      0b0
      0b1 Int64.shift_right by 33 =
      0b0
      0b101 Int64.shift_right by 33 =
      0b0
      0b111 Int64.shift_right by 33 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by 33 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right by 33 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by 33 =
      0b11_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right by 33 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1100_0000_0000_0000_0000_0000_0000_0000
      0b0 Int64.shift_right by 62 =
      0b0
      0b1 Int64.shift_right by 62 =
      0b0
      0b101 Int64.shift_right by 62 =
      0b0
      0b111 Int64.shift_right by 62 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by 62 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right by 62 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by 62 =
      0b1
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right by 62 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1110
      0b0 Int64.shift_right by 63 =
      0b0
      0b1 Int64.shift_right by 63 =
      0b0
      0b101 Int64.shift_right by 63 =
      0b0
      0b111 Int64.shift_right by 63 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by 63 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right by 63 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by 63 =
      0b0
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right by 63 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b0 Int64.shift_right by 64 =
      0b0
      0b1 Int64.shift_right by 64 =
      0b1
      0b101 Int64.shift_right by 64 =
      0b101
      0b111 Int64.shift_right by 64 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by 64 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right by 64 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by 64 =
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right by 64 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Int64.shift_right by 65 =
      0b0
      0b1 Int64.shift_right by 65 =
      0b0
      0b101 Int64.shift_right by 65 =
      0b10
      0b111 Int64.shift_right by 65 =
      0b11
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by 65 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right by 65 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1110
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by 65 =
      0b11_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right by 65 =
      0b1100_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Int64.shift_right by 66 =
      0b0
      0b1 Int64.shift_right by 66 =
      0b0
      0b101 Int64.shift_right by 66 =
      0b1
      0b111 Int64.shift_right by 66 =
      0b1
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by 66 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right by 66 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by 66 =
      0b1_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right by 66 =
      0b1110_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Int64.shift_right by -1 =
      0b0
      0b1 Int64.shift_right by -1 =
      0b0
      0b101 Int64.shift_right by -1 =
      0b0
      0b111 Int64.shift_right by -1 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by -1 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right by -1 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by -1 =
      0b0
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right by -1 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b0 Int64.shift_right by -3 =
      0b0
      0b1 Int64.shift_right by -3 =
      0b0
      0b101 Int64.shift_right by -3 =
      0b0
      0b111 Int64.shift_right by -3 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by -3 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right by -3 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by -3 =
      0b11
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right by -3 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1100
      0b0 Int64.shift_right by 9_223_372_036_854_775_807 =
      0b0
      0b1 Int64.shift_right by 9_223_372_036_854_775_807 =
      0b0
      0b101 Int64.shift_right by 9_223_372_036_854_775_807 =
      0b0
      0b111 Int64.shift_right by 9_223_372_036_854_775_807 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by 9_223_372_036_854_775_807 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right by 9_223_372_036_854_775_807 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by 9_223_372_036_854_775_807 =
      0b0
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right by 9_223_372_036_854_775_807 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b0 Int64.shift_right by -9_223_372_036_854_775_808 =
      0b0
      0b1 Int64.shift_right by -9_223_372_036_854_775_808 =
      0b1
      0b101 Int64.shift_right by -9_223_372_036_854_775_808 =
      0b101
      0b111 Int64.shift_right by -9_223_372_036_854_775_808 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by -9_223_372_036_854_775_808 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right by -9_223_372_036_854_775_808 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right by -9_223_372_036_854_775_808 =
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right by -9_223_372_036_854_775_808 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      |}];
    ()
  ;;

  let%expect_test "shift_right_logical int64" =
    test
      ~op:I.Int64.shift_right_logical
      ~expected_op:I.Int64.Naive.shift_right_logical
      ~name:"Int64.shift_right_logical";
    [%expect
      {|
      0b0 Int64.shift_right_logical by 0 =
      0b0
      0b1 Int64.shift_right_logical by 0 =
      0b1
      0b101 Int64.shift_right_logical by 0 =
      0b101
      0b111 Int64.shift_right_logical by 0 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by 0 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right_logical by 0 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by 0 =
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right_logical by 0 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Int64.shift_right_logical by 1 =
      0b0
      0b1 Int64.shift_right_logical by 1 =
      0b0
      0b101 Int64.shift_right_logical by 1 =
      0b10
      0b111 Int64.shift_right_logical by 1 =
      0b11
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by 1 =
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right_logical by 1 =
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1110
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by 1 =
      0b11_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right_logical by 1 =
      0b100_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Int64.shift_right_logical by 2 =
      0b0
      0b1 Int64.shift_right_logical by 2 =
      0b0
      0b101 Int64.shift_right_logical by 2 =
      0b1
      0b111 Int64.shift_right_logical by 2 =
      0b1
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by 2 =
      0b11_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right_logical by 2 =
      0b11_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by 2 =
      0b1_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right_logical by 2 =
      0b10_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Int64.shift_right_logical by 3 =
      0b0
      0b1 Int64.shift_right_logical by 3 =
      0b0
      0b101 Int64.shift_right_logical by 3 =
      0b0
      0b111 Int64.shift_right_logical by 3 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by 3 =
      0b1_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right_logical by 3 =
      0b1_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by 3 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right_logical by 3 =
      0b1_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Int64.shift_right_logical by 4 =
      0b0
      0b1 Int64.shift_right_logical by 4 =
      0b0
      0b101 Int64.shift_right_logical by 4 =
      0b0
      0b111 Int64.shift_right_logical by 4 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by 4 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right_logical by 4 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by 4 =
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right_logical by 4 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Int64.shift_right_logical by 31 =
      0b0
      0b1 Int64.shift_right_logical by 31 =
      0b0
      0b101 Int64.shift_right_logical by 31 =
      0b0
      0b111 Int64.shift_right_logical by 31 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by 31 =
      0b1_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right_logical by 31 =
      0b1_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by 31 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right_logical by 31 =
      0b1_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Int64.shift_right_logical by 32 =
      0b0
      0b1 Int64.shift_right_logical by 32 =
      0b0
      0b101 Int64.shift_right_logical by 32 =
      0b0
      0b111 Int64.shift_right_logical by 32 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by 32 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right_logical by 32 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by 32 =
      0b111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right_logical by 32 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b0 Int64.shift_right_logical by 33 =
      0b0
      0b1 Int64.shift_right_logical by 33 =
      0b0
      0b101 Int64.shift_right_logical by 33 =
      0b0
      0b111 Int64.shift_right_logical by 33 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by 33 =
      0b111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right_logical by 33 =
      0b111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by 33 =
      0b11_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right_logical by 33 =
      0b100_0000_0000_0000_0000_0000_0000_0000
      0b0 Int64.shift_right_logical by 62 =
      0b0
      0b1 Int64.shift_right_logical by 62 =
      0b0
      0b101 Int64.shift_right_logical by 62 =
      0b0
      0b111 Int64.shift_right_logical by 62 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by 62 =
      0b11
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right_logical by 62 =
      0b11
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by 62 =
      0b1
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right_logical by 62 =
      0b10
      0b0 Int64.shift_right_logical by 63 =
      0b0
      0b1 Int64.shift_right_logical by 63 =
      0b0
      0b101 Int64.shift_right_logical by 63 =
      0b0
      0b111 Int64.shift_right_logical by 63 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by 63 =
      0b1
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right_logical by 63 =
      0b1
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by 63 =
      0b0
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right_logical by 63 =
      0b1
      0b0 Int64.shift_right_logical by 64 =
      0b0
      0b1 Int64.shift_right_logical by 64 =
      0b1
      0b101 Int64.shift_right_logical by 64 =
      0b101
      0b111 Int64.shift_right_logical by 64 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by 64 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right_logical by 64 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by 64 =
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right_logical by 64 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Int64.shift_right_logical by 65 =
      0b0
      0b1 Int64.shift_right_logical by 65 =
      0b0
      0b101 Int64.shift_right_logical by 65 =
      0b10
      0b111 Int64.shift_right_logical by 65 =
      0b11
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by 65 =
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right_logical by 65 =
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1110
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by 65 =
      0b11_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right_logical by 65 =
      0b100_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Int64.shift_right_logical by 66 =
      0b0
      0b1 Int64.shift_right_logical by 66 =
      0b0
      0b101 Int64.shift_right_logical by 66 =
      0b1
      0b111 Int64.shift_right_logical by 66 =
      0b1
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by 66 =
      0b11_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right_logical by 66 =
      0b11_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by 66 =
      0b1_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right_logical by 66 =
      0b10_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Int64.shift_right_logical by -1 =
      0b0
      0b1 Int64.shift_right_logical by -1 =
      0b0
      0b101 Int64.shift_right_logical by -1 =
      0b0
      0b111 Int64.shift_right_logical by -1 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by -1 =
      0b1
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right_logical by -1 =
      0b1
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by -1 =
      0b0
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right_logical by -1 =
      0b1
      0b0 Int64.shift_right_logical by -3 =
      0b0
      0b1 Int64.shift_right_logical by -3 =
      0b0
      0b101 Int64.shift_right_logical by -3 =
      0b0
      0b111 Int64.shift_right_logical by -3 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by -3 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right_logical by -3 =
      0b111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by -3 =
      0b11
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right_logical by -3 =
      0b100
      0b0 Int64.shift_right_logical by 9_223_372_036_854_775_807 =
      0b0
      0b1 Int64.shift_right_logical by 9_223_372_036_854_775_807 =
      0b0
      0b101 Int64.shift_right_logical by 9_223_372_036_854_775_807 =
      0b0
      0b111 Int64.shift_right_logical by 9_223_372_036_854_775_807 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by 9_223_372_036_854_775_807 =
      0b1
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right_logical by 9_223_372_036_854_775_807 =
      0b1
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by 9_223_372_036_854_775_807 =
      0b0
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right_logical by 9_223_372_036_854_775_807 =
      0b1
      0b0 Int64.shift_right_logical by -9_223_372_036_854_775_808 =
      0b0
      0b1 Int64.shift_right_logical by -9_223_372_036_854_775_808 =
      0b1
      0b101 Int64.shift_right_logical by -9_223_372_036_854_775_808 =
      0b101
      0b111 Int64.shift_right_logical by -9_223_372_036_854_775_808 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by -9_223_372_036_854_775_808 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Int64.shift_right_logical by -9_223_372_036_854_775_808 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Int64.shift_right_logical by -9_223_372_036_854_775_808 =
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Int64.shift_right_logical by -9_223_372_036_854_775_808 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      |}];
    ()
  ;;
end

module%test Int32 = struct
  open Int32

  let numbers = List.map ~f:of_int_exn numbers @ [ max_value; min_value ]
  let shifts = List.map ~f:of_int_exn shifts @ [ max_value; min_value ]

  let test ~op ~expected_op ~name =
    let f ~shift x =
      test_shifts (module Binary) (module Int32) ~op ~expected_op ~name x shift
    in
    List.iter shifts ~f:(fun shift ->
      let f = f ~shift in
      List.iter ~f numbers)
  ;;

  let%expect_test "shift_left int32" =
    test
      ~op:I.Int32.shift_left
      ~expected_op:I.Int32.Naive.shift_left
      ~name:"Int32.shift_left";
    [%expect
      {|
      0b0 Int32.shift_left by 0 =
      0b0
      0b1 Int32.shift_left by 0 =
      0b1
      0b101 Int32.shift_left by 0 =
      0b101
      0b111 Int32.shift_left by 0 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by 0 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_left by 0 =
      0b1111_1111_1111_1111_1111_1111_1111_1101
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by 0 =
      0b111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_left by 0 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b0 Int32.shift_left by 1 =
      0b0
      0b1 Int32.shift_left by 1 =
      0b10
      0b101 Int32.shift_left by 1 =
      0b1010
      0b111 Int32.shift_left by 1 =
      0b1110
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by 1 =
      0b1111_1111_1111_1111_1111_1111_1111_1110
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_left by 1 =
      0b1111_1111_1111_1111_1111_1111_1111_1010
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by 1 =
      0b1111_1111_1111_1111_1111_1111_1111_1110
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_left by 1 =
      0b0
      0b0 Int32.shift_left by 2 =
      0b0
      0b1 Int32.shift_left by 2 =
      0b100
      0b101 Int32.shift_left by 2 =
      0b1_0100
      0b111 Int32.shift_left by 2 =
      0b1_1100
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by 2 =
      0b1111_1111_1111_1111_1111_1111_1111_1100
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_left by 2 =
      0b1111_1111_1111_1111_1111_1111_1111_0100
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by 2 =
      0b1111_1111_1111_1111_1111_1111_1111_1100
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_left by 2 =
      0b0
      0b0 Int32.shift_left by 3 =
      0b0
      0b1 Int32.shift_left by 3 =
      0b1000
      0b101 Int32.shift_left by 3 =
      0b10_1000
      0b111 Int32.shift_left by 3 =
      0b11_1000
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by 3 =
      0b1111_1111_1111_1111_1111_1111_1111_1000
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_left by 3 =
      0b1111_1111_1111_1111_1111_1111_1110_1000
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by 3 =
      0b1111_1111_1111_1111_1111_1111_1111_1000
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_left by 3 =
      0b0
      0b0 Int32.shift_left by 4 =
      0b0
      0b1 Int32.shift_left by 4 =
      0b1_0000
      0b101 Int32.shift_left by 4 =
      0b101_0000
      0b111 Int32.shift_left by 4 =
      0b111_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by 4 =
      0b1111_1111_1111_1111_1111_1111_1111_0000
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_left by 4 =
      0b1111_1111_1111_1111_1111_1111_1101_0000
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by 4 =
      0b1111_1111_1111_1111_1111_1111_1111_0000
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_left by 4 =
      0b0
      0b0 Int32.shift_left by 31 =
      0b0
      0b1 Int32.shift_left by 31 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b101 Int32.shift_left by 31 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b111 Int32.shift_left by 31 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by 31 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_left by 31 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by 31 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_left by 31 =
      0b0
      0b0 Int32.shift_left by 32 =
      0b0
      0b1 Int32.shift_left by 32 =
      0b1
      0b101 Int32.shift_left by 32 =
      0b101
      0b111 Int32.shift_left by 32 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by 32 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_left by 32 =
      0b1111_1111_1111_1111_1111_1111_1111_1101
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by 32 =
      0b111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_left by 32 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b0 Int32.shift_left by 33 =
      0b0
      0b1 Int32.shift_left by 33 =
      0b10
      0b101 Int32.shift_left by 33 =
      0b1010
      0b111 Int32.shift_left by 33 =
      0b1110
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by 33 =
      0b1111_1111_1111_1111_1111_1111_1111_1110
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_left by 33 =
      0b1111_1111_1111_1111_1111_1111_1111_1010
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by 33 =
      0b1111_1111_1111_1111_1111_1111_1111_1110
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_left by 33 =
      0b0
      0b0 Int32.shift_left by 62 =
      0b0
      0b1 Int32.shift_left by 62 =
      0b100_0000_0000_0000_0000_0000_0000_0000
      0b101 Int32.shift_left by 62 =
      0b100_0000_0000_0000_0000_0000_0000_0000
      0b111 Int32.shift_left by 62 =
      0b1100_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by 62 =
      0b1100_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_left by 62 =
      0b100_0000_0000_0000_0000_0000_0000_0000
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by 62 =
      0b1100_0000_0000_0000_0000_0000_0000_0000
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_left by 62 =
      0b0
      0b0 Int32.shift_left by 63 =
      0b0
      0b1 Int32.shift_left by 63 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b101 Int32.shift_left by 63 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b111 Int32.shift_left by 63 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by 63 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_left by 63 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by 63 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_left by 63 =
      0b0
      0b0 Int32.shift_left by 64 =
      0b0
      0b1 Int32.shift_left by 64 =
      0b1
      0b101 Int32.shift_left by 64 =
      0b101
      0b111 Int32.shift_left by 64 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by 64 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_left by 64 =
      0b1111_1111_1111_1111_1111_1111_1111_1101
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by 64 =
      0b111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_left by 64 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b0 Int32.shift_left by 65 =
      0b0
      0b1 Int32.shift_left by 65 =
      0b10
      0b101 Int32.shift_left by 65 =
      0b1010
      0b111 Int32.shift_left by 65 =
      0b1110
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by 65 =
      0b1111_1111_1111_1111_1111_1111_1111_1110
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_left by 65 =
      0b1111_1111_1111_1111_1111_1111_1111_1010
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by 65 =
      0b1111_1111_1111_1111_1111_1111_1111_1110
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_left by 65 =
      0b0
      0b0 Int32.shift_left by 66 =
      0b0
      0b1 Int32.shift_left by 66 =
      0b100
      0b101 Int32.shift_left by 66 =
      0b1_0100
      0b111 Int32.shift_left by 66 =
      0b1_1100
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by 66 =
      0b1111_1111_1111_1111_1111_1111_1111_1100
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_left by 66 =
      0b1111_1111_1111_1111_1111_1111_1111_0100
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by 66 =
      0b1111_1111_1111_1111_1111_1111_1111_1100
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_left by 66 =
      0b0
      0b0 Int32.shift_left by -1 =
      0b0
      0b1 Int32.shift_left by -1 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b101 Int32.shift_left by -1 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b111 Int32.shift_left by -1 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by -1 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_left by -1 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by -1 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_left by -1 =
      0b0
      0b0 Int32.shift_left by -3 =
      0b0
      0b1 Int32.shift_left by -3 =
      0b10_0000_0000_0000_0000_0000_0000_0000
      0b101 Int32.shift_left by -3 =
      0b1010_0000_0000_0000_0000_0000_0000_0000
      0b111 Int32.shift_left by -3 =
      0b1110_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by -3 =
      0b1110_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_left by -3 =
      0b1010_0000_0000_0000_0000_0000_0000_0000
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by -3 =
      0b1110_0000_0000_0000_0000_0000_0000_0000
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_left by -3 =
      0b0
      0b0 Int32.shift_left by 2_147_483_647 =
      0b0
      0b1 Int32.shift_left by 2_147_483_647 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b101 Int32.shift_left by 2_147_483_647 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b111 Int32.shift_left by 2_147_483_647 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by 2_147_483_647 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_left by 2_147_483_647 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by 2_147_483_647 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_left by 2_147_483_647 =
      0b0
      0b0 Int32.shift_left by -2_147_483_648 =
      0b0
      0b1 Int32.shift_left by -2_147_483_648 =
      0b1
      0b101 Int32.shift_left by -2_147_483_648 =
      0b101
      0b111 Int32.shift_left by -2_147_483_648 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by -2_147_483_648 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_left by -2_147_483_648 =
      0b1111_1111_1111_1111_1111_1111_1111_1101
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_left by -2_147_483_648 =
      0b111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_left by -2_147_483_648 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      |}];
    ()
  ;;

  let%expect_test "shift_right int32" =
    test
      ~op:I.Int32.shift_right
      ~expected_op:I.Int32.Naive.shift_right
      ~name:"Int32.shift_right";
    [%expect
      {|
      0b0 Int32.shift_right by 0 =
      0b0
      0b1 Int32.shift_right by 0 =
      0b1
      0b101 Int32.shift_right by 0 =
      0b101
      0b111 Int32.shift_right by 0 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by 0 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right by 0 =
      0b1111_1111_1111_1111_1111_1111_1111_1101
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by 0 =
      0b111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right by 0 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b0 Int32.shift_right by 1 =
      0b0
      0b1 Int32.shift_right by 1 =
      0b0
      0b101 Int32.shift_right by 1 =
      0b10
      0b111 Int32.shift_right by 1 =
      0b11
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by 1 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right by 1 =
      0b1111_1111_1111_1111_1111_1111_1111_1110
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by 1 =
      0b11_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right by 1 =
      0b1100_0000_0000_0000_0000_0000_0000_0000
      0b0 Int32.shift_right by 2 =
      0b0
      0b1 Int32.shift_right by 2 =
      0b0
      0b101 Int32.shift_right by 2 =
      0b1
      0b111 Int32.shift_right by 2 =
      0b1
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by 2 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right by 2 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by 2 =
      0b1_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right by 2 =
      0b1110_0000_0000_0000_0000_0000_0000_0000
      0b0 Int32.shift_right by 3 =
      0b0
      0b1 Int32.shift_right by 3 =
      0b0
      0b101 Int32.shift_right by 3 =
      0b0
      0b111 Int32.shift_right by 3 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by 3 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right by 3 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by 3 =
      0b1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right by 3 =
      0b1111_0000_0000_0000_0000_0000_0000_0000
      0b0 Int32.shift_right by 4 =
      0b0
      0b1 Int32.shift_right by 4 =
      0b0
      0b101 Int32.shift_right by 4 =
      0b0
      0b111 Int32.shift_right by 4 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by 4 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right by 4 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by 4 =
      0b111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right by 4 =
      0b1111_1000_0000_0000_0000_0000_0000_0000
      0b0 Int32.shift_right by 31 =
      0b0
      0b1 Int32.shift_right by 31 =
      0b0
      0b101 Int32.shift_right by 31 =
      0b0
      0b111 Int32.shift_right by 31 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by 31 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right by 31 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by 31 =
      0b0
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right by 31 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b0 Int32.shift_right by 32 =
      0b0
      0b1 Int32.shift_right by 32 =
      0b1
      0b101 Int32.shift_right by 32 =
      0b101
      0b111 Int32.shift_right by 32 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by 32 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right by 32 =
      0b1111_1111_1111_1111_1111_1111_1111_1101
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by 32 =
      0b111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right by 32 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b0 Int32.shift_right by 33 =
      0b0
      0b1 Int32.shift_right by 33 =
      0b0
      0b101 Int32.shift_right by 33 =
      0b10
      0b111 Int32.shift_right by 33 =
      0b11
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by 33 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right by 33 =
      0b1111_1111_1111_1111_1111_1111_1111_1110
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by 33 =
      0b11_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right by 33 =
      0b1100_0000_0000_0000_0000_0000_0000_0000
      0b0 Int32.shift_right by 62 =
      0b0
      0b1 Int32.shift_right by 62 =
      0b0
      0b101 Int32.shift_right by 62 =
      0b0
      0b111 Int32.shift_right by 62 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by 62 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right by 62 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by 62 =
      0b1
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right by 62 =
      0b1111_1111_1111_1111_1111_1111_1111_1110
      0b0 Int32.shift_right by 63 =
      0b0
      0b1 Int32.shift_right by 63 =
      0b0
      0b101 Int32.shift_right by 63 =
      0b0
      0b111 Int32.shift_right by 63 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by 63 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right by 63 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by 63 =
      0b0
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right by 63 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b0 Int32.shift_right by 64 =
      0b0
      0b1 Int32.shift_right by 64 =
      0b1
      0b101 Int32.shift_right by 64 =
      0b101
      0b111 Int32.shift_right by 64 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by 64 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right by 64 =
      0b1111_1111_1111_1111_1111_1111_1111_1101
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by 64 =
      0b111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right by 64 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b0 Int32.shift_right by 65 =
      0b0
      0b1 Int32.shift_right by 65 =
      0b0
      0b101 Int32.shift_right by 65 =
      0b10
      0b111 Int32.shift_right by 65 =
      0b11
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by 65 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right by 65 =
      0b1111_1111_1111_1111_1111_1111_1111_1110
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by 65 =
      0b11_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right by 65 =
      0b1100_0000_0000_0000_0000_0000_0000_0000
      0b0 Int32.shift_right by 66 =
      0b0
      0b1 Int32.shift_right by 66 =
      0b0
      0b101 Int32.shift_right by 66 =
      0b1
      0b111 Int32.shift_right by 66 =
      0b1
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by 66 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right by 66 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by 66 =
      0b1_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right by 66 =
      0b1110_0000_0000_0000_0000_0000_0000_0000
      0b0 Int32.shift_right by -1 =
      0b0
      0b1 Int32.shift_right by -1 =
      0b0
      0b101 Int32.shift_right by -1 =
      0b0
      0b111 Int32.shift_right by -1 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by -1 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right by -1 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by -1 =
      0b0
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right by -1 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b0 Int32.shift_right by -3 =
      0b0
      0b1 Int32.shift_right by -3 =
      0b0
      0b101 Int32.shift_right by -3 =
      0b0
      0b111 Int32.shift_right by -3 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by -3 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right by -3 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by -3 =
      0b11
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right by -3 =
      0b1111_1111_1111_1111_1111_1111_1111_1100
      0b0 Int32.shift_right by 2_147_483_647 =
      0b0
      0b1 Int32.shift_right by 2_147_483_647 =
      0b0
      0b101 Int32.shift_right by 2_147_483_647 =
      0b0
      0b111 Int32.shift_right by 2_147_483_647 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by 2_147_483_647 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right by 2_147_483_647 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by 2_147_483_647 =
      0b0
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right by 2_147_483_647 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b0 Int32.shift_right by -2_147_483_648 =
      0b0
      0b1 Int32.shift_right by -2_147_483_648 =
      0b1
      0b101 Int32.shift_right by -2_147_483_648 =
      0b101
      0b111 Int32.shift_right by -2_147_483_648 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by -2_147_483_648 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right by -2_147_483_648 =
      0b1111_1111_1111_1111_1111_1111_1111_1101
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right by -2_147_483_648 =
      0b111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right by -2_147_483_648 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      |}];
    ()
  ;;

  let%expect_test "shift_right_logical int32" =
    test
      ~op:I.Int32.shift_right_logical
      ~expected_op:I.Int32.Naive.shift_right_logical
      ~name:"Int32.shift_right_logical";
    [%expect
      {|
      0b0 Int32.shift_right_logical by 0 =
      0b0
      0b1 Int32.shift_right_logical by 0 =
      0b1
      0b101 Int32.shift_right_logical by 0 =
      0b101
      0b111 Int32.shift_right_logical by 0 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by 0 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right_logical by 0 =
      0b1111_1111_1111_1111_1111_1111_1111_1101
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by 0 =
      0b111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right_logical by 0 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b0 Int32.shift_right_logical by 1 =
      0b0
      0b1 Int32.shift_right_logical by 1 =
      0b0
      0b101 Int32.shift_right_logical by 1 =
      0b10
      0b111 Int32.shift_right_logical by 1 =
      0b11
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by 1 =
      0b111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right_logical by 1 =
      0b111_1111_1111_1111_1111_1111_1111_1110
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by 1 =
      0b11_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right_logical by 1 =
      0b100_0000_0000_0000_0000_0000_0000_0000
      0b0 Int32.shift_right_logical by 2 =
      0b0
      0b1 Int32.shift_right_logical by 2 =
      0b0
      0b101 Int32.shift_right_logical by 2 =
      0b1
      0b111 Int32.shift_right_logical by 2 =
      0b1
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by 2 =
      0b11_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right_logical by 2 =
      0b11_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by 2 =
      0b1_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right_logical by 2 =
      0b10_0000_0000_0000_0000_0000_0000_0000
      0b0 Int32.shift_right_logical by 3 =
      0b0
      0b1 Int32.shift_right_logical by 3 =
      0b0
      0b101 Int32.shift_right_logical by 3 =
      0b0
      0b111 Int32.shift_right_logical by 3 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by 3 =
      0b1_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right_logical by 3 =
      0b1_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by 3 =
      0b1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right_logical by 3 =
      0b1_0000_0000_0000_0000_0000_0000_0000
      0b0 Int32.shift_right_logical by 4 =
      0b0
      0b1 Int32.shift_right_logical by 4 =
      0b0
      0b101 Int32.shift_right_logical by 4 =
      0b0
      0b111 Int32.shift_right_logical by 4 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by 4 =
      0b1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right_logical by 4 =
      0b1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by 4 =
      0b111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right_logical by 4 =
      0b1000_0000_0000_0000_0000_0000_0000
      0b0 Int32.shift_right_logical by 31 =
      0b0
      0b1 Int32.shift_right_logical by 31 =
      0b0
      0b101 Int32.shift_right_logical by 31 =
      0b0
      0b111 Int32.shift_right_logical by 31 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by 31 =
      0b1
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right_logical by 31 =
      0b1
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by 31 =
      0b0
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right_logical by 31 =
      0b1
      0b0 Int32.shift_right_logical by 32 =
      0b0
      0b1 Int32.shift_right_logical by 32 =
      0b1
      0b101 Int32.shift_right_logical by 32 =
      0b101
      0b111 Int32.shift_right_logical by 32 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by 32 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right_logical by 32 =
      0b1111_1111_1111_1111_1111_1111_1111_1101
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by 32 =
      0b111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right_logical by 32 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b0 Int32.shift_right_logical by 33 =
      0b0
      0b1 Int32.shift_right_logical by 33 =
      0b0
      0b101 Int32.shift_right_logical by 33 =
      0b10
      0b111 Int32.shift_right_logical by 33 =
      0b11
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by 33 =
      0b111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right_logical by 33 =
      0b111_1111_1111_1111_1111_1111_1111_1110
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by 33 =
      0b11_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right_logical by 33 =
      0b100_0000_0000_0000_0000_0000_0000_0000
      0b0 Int32.shift_right_logical by 62 =
      0b0
      0b1 Int32.shift_right_logical by 62 =
      0b0
      0b101 Int32.shift_right_logical by 62 =
      0b0
      0b111 Int32.shift_right_logical by 62 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by 62 =
      0b11
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right_logical by 62 =
      0b11
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by 62 =
      0b1
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right_logical by 62 =
      0b10
      0b0 Int32.shift_right_logical by 63 =
      0b0
      0b1 Int32.shift_right_logical by 63 =
      0b0
      0b101 Int32.shift_right_logical by 63 =
      0b0
      0b111 Int32.shift_right_logical by 63 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by 63 =
      0b1
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right_logical by 63 =
      0b1
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by 63 =
      0b0
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right_logical by 63 =
      0b1
      0b0 Int32.shift_right_logical by 64 =
      0b0
      0b1 Int32.shift_right_logical by 64 =
      0b1
      0b101 Int32.shift_right_logical by 64 =
      0b101
      0b111 Int32.shift_right_logical by 64 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by 64 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right_logical by 64 =
      0b1111_1111_1111_1111_1111_1111_1111_1101
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by 64 =
      0b111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right_logical by 64 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b0 Int32.shift_right_logical by 65 =
      0b0
      0b1 Int32.shift_right_logical by 65 =
      0b0
      0b101 Int32.shift_right_logical by 65 =
      0b10
      0b111 Int32.shift_right_logical by 65 =
      0b11
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by 65 =
      0b111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right_logical by 65 =
      0b111_1111_1111_1111_1111_1111_1111_1110
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by 65 =
      0b11_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right_logical by 65 =
      0b100_0000_0000_0000_0000_0000_0000_0000
      0b0 Int32.shift_right_logical by 66 =
      0b0
      0b1 Int32.shift_right_logical by 66 =
      0b0
      0b101 Int32.shift_right_logical by 66 =
      0b1
      0b111 Int32.shift_right_logical by 66 =
      0b1
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by 66 =
      0b11_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right_logical by 66 =
      0b11_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by 66 =
      0b1_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right_logical by 66 =
      0b10_0000_0000_0000_0000_0000_0000_0000
      0b0 Int32.shift_right_logical by -1 =
      0b0
      0b1 Int32.shift_right_logical by -1 =
      0b0
      0b101 Int32.shift_right_logical by -1 =
      0b0
      0b111 Int32.shift_right_logical by -1 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by -1 =
      0b1
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right_logical by -1 =
      0b1
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by -1 =
      0b0
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right_logical by -1 =
      0b1
      0b0 Int32.shift_right_logical by -3 =
      0b0
      0b1 Int32.shift_right_logical by -3 =
      0b0
      0b101 Int32.shift_right_logical by -3 =
      0b0
      0b111 Int32.shift_right_logical by -3 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by -3 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right_logical by -3 =
      0b111
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by -3 =
      0b11
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right_logical by -3 =
      0b100
      0b0 Int32.shift_right_logical by 2_147_483_647 =
      0b0
      0b1 Int32.shift_right_logical by 2_147_483_647 =
      0b0
      0b101 Int32.shift_right_logical by 2_147_483_647 =
      0b0
      0b111 Int32.shift_right_logical by 2_147_483_647 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by 2_147_483_647 =
      0b1
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right_logical by 2_147_483_647 =
      0b1
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by 2_147_483_647 =
      0b0
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right_logical by 2_147_483_647 =
      0b1
      0b0 Int32.shift_right_logical by -2_147_483_648 =
      0b0
      0b1 Int32.shift_right_logical by -2_147_483_648 =
      0b1
      0b101 Int32.shift_right_logical by -2_147_483_648 =
      0b101
      0b111 Int32.shift_right_logical by -2_147_483_648 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by -2_147_483_648 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1101 Int32.shift_right_logical by -2_147_483_648 =
      0b1111_1111_1111_1111_1111_1111_1111_1101
      0b111_1111_1111_1111_1111_1111_1111_1111 Int32.shift_right_logical by -2_147_483_648 =
      0b111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000 Int32.shift_right_logical by -2_147_483_648 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      |}];
    ()
  ;;
end

module%test [@tags "64-bits-only"] Nativeint_arch64 = struct
  open Nativeint

  let numbers = List.map ~f:of_int_exn numbers @ [ max_value; min_value ]
  let shifts = List.map ~f:of_int_exn shifts @ [ max_value; min_value ]

  let test ~op ~expected_op ~name =
    let f ~shift x =
      test_shifts (module Binary) (module Nativeint) ~op ~expected_op ~name x shift
    in
    List.iter shifts ~f:(fun shift ->
      let f = f ~shift in
      List.iter ~f numbers)
  ;;

  let%expect_test "shift_left nativeint" =
    test
      ~op:I.Nativeint.shift_left
      ~expected_op:I.Nativeint.Naive.shift_left
      ~name:"Nativeint.shift_left";
    [%expect
      {|
      0b0 Nativeint.shift_left by 0 =
      0b0
      0b1 Nativeint.shift_left by 0 =
      0b1
      0b101 Nativeint.shift_left by 0 =
      0b101
      0b111 Nativeint.shift_left by 0 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by 0 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_left by 0 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by 0 =
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_left by 0 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Nativeint.shift_left by 1 =
      0b0
      0b1 Nativeint.shift_left by 1 =
      0b10
      0b101 Nativeint.shift_left by 1 =
      0b1010
      0b111 Nativeint.shift_left by 1 =
      0b1110
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by 1 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1110
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_left by 1 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1010
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by 1 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1110
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_left by 1 =
      0b0
      0b0 Nativeint.shift_left by 2 =
      0b0
      0b1 Nativeint.shift_left by 2 =
      0b100
      0b101 Nativeint.shift_left by 2 =
      0b1_0100
      0b111 Nativeint.shift_left by 2 =
      0b1_1100
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by 2 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1100
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_left by 2 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_0100
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by 2 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1100
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_left by 2 =
      0b0
      0b0 Nativeint.shift_left by 3 =
      0b0
      0b1 Nativeint.shift_left by 3 =
      0b1000
      0b101 Nativeint.shift_left by 3 =
      0b10_1000
      0b111 Nativeint.shift_left by 3 =
      0b11_1000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by 3 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_left by 3 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1110_1000
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by 3 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1000
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_left by 3 =
      0b0
      0b0 Nativeint.shift_left by 4 =
      0b0
      0b1 Nativeint.shift_left by 4 =
      0b1_0000
      0b101 Nativeint.shift_left by 4 =
      0b101_0000
      0b111 Nativeint.shift_left by 4 =
      0b111_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by 4 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_left by 4 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101_0000
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by 4 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_0000
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_left by 4 =
      0b0
      0b0 Nativeint.shift_left by 31 =
      0b0
      0b1 Nativeint.shift_left by 31 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b101 Nativeint.shift_left by 31 =
      0b10_1000_0000_0000_0000_0000_0000_0000_0000
      0b111 Nativeint.shift_left by 31 =
      0b11_1000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by 31 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_left by 31 =
      0b1111_1111_1111_1111_1111_1111_1111_1110_1000_0000_0000_0000_0000_0000_0000_0000
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by 31 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1000_0000_0000_0000_0000_0000_0000_0000
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_left by 31 =
      0b0
      0b0 Nativeint.shift_left by 32 =
      0b0
      0b1 Nativeint.shift_left by 32 =
      0b1_0000_0000_0000_0000_0000_0000_0000_0000
      0b101 Nativeint.shift_left by 32 =
      0b101_0000_0000_0000_0000_0000_0000_0000_0000
      0b111 Nativeint.shift_left by 32 =
      0b111_0000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by 32 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_0000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_left by 32 =
      0b1111_1111_1111_1111_1111_1111_1111_1101_0000_0000_0000_0000_0000_0000_0000_0000
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by 32 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_0000_0000_0000_0000_0000_0000_0000_0000
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_left by 32 =
      0b0
      0b0 Nativeint.shift_left by 33 =
      0b0
      0b1 Nativeint.shift_left by 33 =
      0b10_0000_0000_0000_0000_0000_0000_0000_0000
      0b101 Nativeint.shift_left by 33 =
      0b1010_0000_0000_0000_0000_0000_0000_0000_0000
      0b111 Nativeint.shift_left by 33 =
      0b1110_0000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by 33 =
      0b1111_1111_1111_1111_1111_1111_1111_1110_0000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_left by 33 =
      0b1111_1111_1111_1111_1111_1111_1111_1010_0000_0000_0000_0000_0000_0000_0000_0000
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by 33 =
      0b1111_1111_1111_1111_1111_1111_1111_1110_0000_0000_0000_0000_0000_0000_0000_0000
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_left by 33 =
      0b0
      0b0 Nativeint.shift_left by 62 =
      0b0
      0b1 Nativeint.shift_left by 62 =
      0b100_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b101 Nativeint.shift_left by 62 =
      0b100_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b111 Nativeint.shift_left by 62 =
      0b1100_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by 62 =
      0b1100_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_left by 62 =
      0b100_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by 62 =
      0b1100_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_left by 62 =
      0b0
      0b0 Nativeint.shift_left by 63 =
      0b0
      0b1 Nativeint.shift_left by 63 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b101 Nativeint.shift_left by 63 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b111 Nativeint.shift_left by 63 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by 63 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_left by 63 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by 63 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_left by 63 =
      0b0
      0b0 Nativeint.shift_left by 64 =
      0b0
      0b1 Nativeint.shift_left by 64 =
      0b1
      0b101 Nativeint.shift_left by 64 =
      0b101
      0b111 Nativeint.shift_left by 64 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by 64 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_left by 64 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by 64 =
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_left by 64 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Nativeint.shift_left by 65 =
      0b0
      0b1 Nativeint.shift_left by 65 =
      0b10
      0b101 Nativeint.shift_left by 65 =
      0b1010
      0b111 Nativeint.shift_left by 65 =
      0b1110
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by 65 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1110
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_left by 65 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1010
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by 65 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1110
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_left by 65 =
      0b0
      0b0 Nativeint.shift_left by 66 =
      0b0
      0b1 Nativeint.shift_left by 66 =
      0b100
      0b101 Nativeint.shift_left by 66 =
      0b1_0100
      0b111 Nativeint.shift_left by 66 =
      0b1_1100
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by 66 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1100
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_left by 66 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_0100
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by 66 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1100
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_left by 66 =
      0b0
      0b0 Nativeint.shift_left by -1 =
      0b0
      0b1 Nativeint.shift_left by -1 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b101 Nativeint.shift_left by -1 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b111 Nativeint.shift_left by -1 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by -1 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_left by -1 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by -1 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_left by -1 =
      0b0
      0b0 Nativeint.shift_left by -3 =
      0b0
      0b1 Nativeint.shift_left by -3 =
      0b10_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b101 Nativeint.shift_left by -3 =
      0b1010_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b111 Nativeint.shift_left by -3 =
      0b1110_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by -3 =
      0b1110_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_left by -3 =
      0b1010_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by -3 =
      0b1110_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_left by -3 =
      0b0
      0b0 Nativeint.shift_left by 9_223_372_036_854_775_807 =
      0b0
      0b1 Nativeint.shift_left by 9_223_372_036_854_775_807 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b101 Nativeint.shift_left by 9_223_372_036_854_775_807 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b111 Nativeint.shift_left by 9_223_372_036_854_775_807 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by 9_223_372_036_854_775_807 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_left by 9_223_372_036_854_775_807 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by 9_223_372_036_854_775_807 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_left by 9_223_372_036_854_775_807 =
      0b0
      0b0 Nativeint.shift_left by -9_223_372_036_854_775_808 =
      0b0
      0b1 Nativeint.shift_left by -9_223_372_036_854_775_808 =
      0b1
      0b101 Nativeint.shift_left by -9_223_372_036_854_775_808 =
      0b101
      0b111 Nativeint.shift_left by -9_223_372_036_854_775_808 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by -9_223_372_036_854_775_808 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_left by -9_223_372_036_854_775_808 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_left by -9_223_372_036_854_775_808 =
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_left by -9_223_372_036_854_775_808 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      |}];
    ()
  ;;

  let%expect_test "shift_right nativeint" =
    test
      ~op:I.Nativeint.shift_right
      ~expected_op:I.Nativeint.Naive.shift_right
      ~name:"Nativeint.shift_right";
    [%expect
      {|
      0b0 Nativeint.shift_right by 0 =
      0b0
      0b1 Nativeint.shift_right by 0 =
      0b1
      0b101 Nativeint.shift_right by 0 =
      0b101
      0b111 Nativeint.shift_right by 0 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by 0 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right by 0 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by 0 =
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right by 0 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Nativeint.shift_right by 1 =
      0b0
      0b1 Nativeint.shift_right by 1 =
      0b0
      0b101 Nativeint.shift_right by 1 =
      0b10
      0b111 Nativeint.shift_right by 1 =
      0b11
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by 1 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right by 1 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1110
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by 1 =
      0b11_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right by 1 =
      0b1100_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Nativeint.shift_right by 2 =
      0b0
      0b1 Nativeint.shift_right by 2 =
      0b0
      0b101 Nativeint.shift_right by 2 =
      0b1
      0b111 Nativeint.shift_right by 2 =
      0b1
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by 2 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right by 2 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by 2 =
      0b1_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right by 2 =
      0b1110_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Nativeint.shift_right by 3 =
      0b0
      0b1 Nativeint.shift_right by 3 =
      0b0
      0b101 Nativeint.shift_right by 3 =
      0b0
      0b111 Nativeint.shift_right by 3 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by 3 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right by 3 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by 3 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right by 3 =
      0b1111_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Nativeint.shift_right by 4 =
      0b0
      0b1 Nativeint.shift_right by 4 =
      0b0
      0b101 Nativeint.shift_right by 4 =
      0b0
      0b111 Nativeint.shift_right by 4 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by 4 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right by 4 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by 4 =
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right by 4 =
      0b1111_1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Nativeint.shift_right by 31 =
      0b0
      0b1 Nativeint.shift_right by 31 =
      0b0
      0b101 Nativeint.shift_right by 31 =
      0b0
      0b111 Nativeint.shift_right by 31 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by 31 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right by 31 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by 31 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right by 31 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Nativeint.shift_right by 32 =
      0b0
      0b1 Nativeint.shift_right by 32 =
      0b0
      0b101 Nativeint.shift_right by 32 =
      0b0
      0b111 Nativeint.shift_right by 32 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by 32 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right by 32 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by 32 =
      0b111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right by 32 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1000_0000_0000_0000_0000_0000_0000_0000
      0b0 Nativeint.shift_right by 33 =
      0b0
      0b1 Nativeint.shift_right by 33 =
      0b0
      0b101 Nativeint.shift_right by 33 =
      0b0
      0b111 Nativeint.shift_right by 33 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by 33 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right by 33 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by 33 =
      0b11_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right by 33 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1100_0000_0000_0000_0000_0000_0000_0000
      0b0 Nativeint.shift_right by 62 =
      0b0
      0b1 Nativeint.shift_right by 62 =
      0b0
      0b101 Nativeint.shift_right by 62 =
      0b0
      0b111 Nativeint.shift_right by 62 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by 62 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right by 62 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by 62 =
      0b1
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right by 62 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1110
      0b0 Nativeint.shift_right by 63 =
      0b0
      0b1 Nativeint.shift_right by 63 =
      0b0
      0b101 Nativeint.shift_right by 63 =
      0b0
      0b111 Nativeint.shift_right by 63 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by 63 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right by 63 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by 63 =
      0b0
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right by 63 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b0 Nativeint.shift_right by 64 =
      0b0
      0b1 Nativeint.shift_right by 64 =
      0b1
      0b101 Nativeint.shift_right by 64 =
      0b101
      0b111 Nativeint.shift_right by 64 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by 64 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right by 64 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by 64 =
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right by 64 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Nativeint.shift_right by 65 =
      0b0
      0b1 Nativeint.shift_right by 65 =
      0b0
      0b101 Nativeint.shift_right by 65 =
      0b10
      0b111 Nativeint.shift_right by 65 =
      0b11
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by 65 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right by 65 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1110
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by 65 =
      0b11_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right by 65 =
      0b1100_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Nativeint.shift_right by 66 =
      0b0
      0b1 Nativeint.shift_right by 66 =
      0b0
      0b101 Nativeint.shift_right by 66 =
      0b1
      0b111 Nativeint.shift_right by 66 =
      0b1
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by 66 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right by 66 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by 66 =
      0b1_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right by 66 =
      0b1110_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Nativeint.shift_right by -1 =
      0b0
      0b1 Nativeint.shift_right by -1 =
      0b0
      0b101 Nativeint.shift_right by -1 =
      0b0
      0b111 Nativeint.shift_right by -1 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by -1 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right by -1 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by -1 =
      0b0
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right by -1 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b0 Nativeint.shift_right by -3 =
      0b0
      0b1 Nativeint.shift_right by -3 =
      0b0
      0b101 Nativeint.shift_right by -3 =
      0b0
      0b111 Nativeint.shift_right by -3 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by -3 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right by -3 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by -3 =
      0b11
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right by -3 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1100
      0b0 Nativeint.shift_right by 9_223_372_036_854_775_807 =
      0b0
      0b1 Nativeint.shift_right by 9_223_372_036_854_775_807 =
      0b0
      0b101 Nativeint.shift_right by 9_223_372_036_854_775_807 =
      0b0
      0b111 Nativeint.shift_right by 9_223_372_036_854_775_807 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by 9_223_372_036_854_775_807 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right by 9_223_372_036_854_775_807 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by 9_223_372_036_854_775_807 =
      0b0
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right by 9_223_372_036_854_775_807 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b0 Nativeint.shift_right by -9_223_372_036_854_775_808 =
      0b0
      0b1 Nativeint.shift_right by -9_223_372_036_854_775_808 =
      0b1
      0b101 Nativeint.shift_right by -9_223_372_036_854_775_808 =
      0b101
      0b111 Nativeint.shift_right by -9_223_372_036_854_775_808 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by -9_223_372_036_854_775_808 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right by -9_223_372_036_854_775_808 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right by -9_223_372_036_854_775_808 =
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right by -9_223_372_036_854_775_808 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      |}];
    ()
  ;;

  let%expect_test "shift_right_logical nativeint" =
    test
      ~op:I.Nativeint.shift_right_logical
      ~expected_op:I.Nativeint.Naive.shift_right_logical
      ~name:"Nativeint.shift_right_logical";
    [%expect
      {|
      0b0 Nativeint.shift_right_logical by 0 =
      0b0
      0b1 Nativeint.shift_right_logical by 0 =
      0b1
      0b101 Nativeint.shift_right_logical by 0 =
      0b101
      0b111 Nativeint.shift_right_logical by 0 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by 0 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right_logical by 0 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by 0 =
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right_logical by 0 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Nativeint.shift_right_logical by 1 =
      0b0
      0b1 Nativeint.shift_right_logical by 1 =
      0b0
      0b101 Nativeint.shift_right_logical by 1 =
      0b10
      0b111 Nativeint.shift_right_logical by 1 =
      0b11
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by 1 =
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right_logical by 1 =
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1110
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by 1 =
      0b11_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right_logical by 1 =
      0b100_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Nativeint.shift_right_logical by 2 =
      0b0
      0b1 Nativeint.shift_right_logical by 2 =
      0b0
      0b101 Nativeint.shift_right_logical by 2 =
      0b1
      0b111 Nativeint.shift_right_logical by 2 =
      0b1
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by 2 =
      0b11_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right_logical by 2 =
      0b11_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by 2 =
      0b1_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right_logical by 2 =
      0b10_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Nativeint.shift_right_logical by 3 =
      0b0
      0b1 Nativeint.shift_right_logical by 3 =
      0b0
      0b101 Nativeint.shift_right_logical by 3 =
      0b0
      0b111 Nativeint.shift_right_logical by 3 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by 3 =
      0b1_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right_logical by 3 =
      0b1_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by 3 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right_logical by 3 =
      0b1_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Nativeint.shift_right_logical by 4 =
      0b0
      0b1 Nativeint.shift_right_logical by 4 =
      0b0
      0b101 Nativeint.shift_right_logical by 4 =
      0b0
      0b111 Nativeint.shift_right_logical by 4 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by 4 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right_logical by 4 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by 4 =
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right_logical by 4 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Nativeint.shift_right_logical by 31 =
      0b0
      0b1 Nativeint.shift_right_logical by 31 =
      0b0
      0b101 Nativeint.shift_right_logical by 31 =
      0b0
      0b111 Nativeint.shift_right_logical by 31 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by 31 =
      0b1_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right_logical by 31 =
      0b1_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by 31 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right_logical by 31 =
      0b1_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Nativeint.shift_right_logical by 32 =
      0b0
      0b1 Nativeint.shift_right_logical by 32 =
      0b0
      0b101 Nativeint.shift_right_logical by 32 =
      0b0
      0b111 Nativeint.shift_right_logical by 32 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by 32 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right_logical by 32 =
      0b1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by 32 =
      0b111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right_logical by 32 =
      0b1000_0000_0000_0000_0000_0000_0000_0000
      0b0 Nativeint.shift_right_logical by 33 =
      0b0
      0b1 Nativeint.shift_right_logical by 33 =
      0b0
      0b101 Nativeint.shift_right_logical by 33 =
      0b0
      0b111 Nativeint.shift_right_logical by 33 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by 33 =
      0b111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right_logical by 33 =
      0b111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by 33 =
      0b11_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right_logical by 33 =
      0b100_0000_0000_0000_0000_0000_0000_0000
      0b0 Nativeint.shift_right_logical by 62 =
      0b0
      0b1 Nativeint.shift_right_logical by 62 =
      0b0
      0b101 Nativeint.shift_right_logical by 62 =
      0b0
      0b111 Nativeint.shift_right_logical by 62 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by 62 =
      0b11
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right_logical by 62 =
      0b11
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by 62 =
      0b1
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right_logical by 62 =
      0b10
      0b0 Nativeint.shift_right_logical by 63 =
      0b0
      0b1 Nativeint.shift_right_logical by 63 =
      0b0
      0b101 Nativeint.shift_right_logical by 63 =
      0b0
      0b111 Nativeint.shift_right_logical by 63 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by 63 =
      0b1
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right_logical by 63 =
      0b1
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by 63 =
      0b0
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right_logical by 63 =
      0b1
      0b0 Nativeint.shift_right_logical by 64 =
      0b0
      0b1 Nativeint.shift_right_logical by 64 =
      0b1
      0b101 Nativeint.shift_right_logical by 64 =
      0b101
      0b111 Nativeint.shift_right_logical by 64 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by 64 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right_logical by 64 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by 64 =
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right_logical by 64 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Nativeint.shift_right_logical by 65 =
      0b0
      0b1 Nativeint.shift_right_logical by 65 =
      0b0
      0b101 Nativeint.shift_right_logical by 65 =
      0b10
      0b111 Nativeint.shift_right_logical by 65 =
      0b11
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by 65 =
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right_logical by 65 =
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1110
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by 65 =
      0b11_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right_logical by 65 =
      0b100_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Nativeint.shift_right_logical by 66 =
      0b0
      0b1 Nativeint.shift_right_logical by 66 =
      0b0
      0b101 Nativeint.shift_right_logical by 66 =
      0b1
      0b111 Nativeint.shift_right_logical by 66 =
      0b1
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by 66 =
      0b11_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right_logical by 66 =
      0b11_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by 66 =
      0b1_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right_logical by 66 =
      0b10_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      0b0 Nativeint.shift_right_logical by -1 =
      0b0
      0b1 Nativeint.shift_right_logical by -1 =
      0b0
      0b101 Nativeint.shift_right_logical by -1 =
      0b0
      0b111 Nativeint.shift_right_logical by -1 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by -1 =
      0b1
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right_logical by -1 =
      0b1
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by -1 =
      0b0
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right_logical by -1 =
      0b1
      0b0 Nativeint.shift_right_logical by -3 =
      0b0
      0b1 Nativeint.shift_right_logical by -3 =
      0b0
      0b101 Nativeint.shift_right_logical by -3 =
      0b0
      0b111 Nativeint.shift_right_logical by -3 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by -3 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right_logical by -3 =
      0b111
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by -3 =
      0b11
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right_logical by -3 =
      0b100
      0b0 Nativeint.shift_right_logical by 9_223_372_036_854_775_807 =
      0b0
      0b1 Nativeint.shift_right_logical by 9_223_372_036_854_775_807 =
      0b0
      0b101 Nativeint.shift_right_logical by 9_223_372_036_854_775_807 =
      0b0
      0b111 Nativeint.shift_right_logical by 9_223_372_036_854_775_807 =
      0b0
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by 9_223_372_036_854_775_807 =
      0b1
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right_logical by 9_223_372_036_854_775_807 =
      0b1
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by 9_223_372_036_854_775_807 =
      0b0
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right_logical by 9_223_372_036_854_775_807 =
      0b1
      0b0 Nativeint.shift_right_logical by -9_223_372_036_854_775_808 =
      0b0
      0b1 Nativeint.shift_right_logical by -9_223_372_036_854_775_808 =
      0b1
      0b101 Nativeint.shift_right_logical by -9_223_372_036_854_775_808 =
      0b101
      0b111 Nativeint.shift_right_logical by -9_223_372_036_854_775_808 =
      0b111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by -9_223_372_036_854_775_808 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101 Nativeint.shift_right_logical by -9_223_372_036_854_775_808 =
      0b1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1101
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111 Nativeint.shift_right_logical by -9_223_372_036_854_775_808 =
      0b111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111_1111
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000 Nativeint.shift_right_logical by -9_223_372_036_854_775_808 =
      0b1000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000
      |}];
    ()
  ;;
end

module%test [@tags "32-bits-only"] Nativeint_arch32 = struct
  open Nativeint

  let numbers = List.map ~f:of_int_exn numbers @ [ max_value; min_value ]
  let shifts = List.map ~f:of_int_exn shifts @ [ max_value; min_value ]

  let test ~op ~expected_op ~name =
    let f ~shift x =
      test_shifts (module Binary) (module Nativeint) ~op ~expected_op ~name x shift
    in
    List.iter shifts ~f:(fun shift ->
      let f = f ~shift in
      List.iter ~f numbers)
  ;;

  let%expect_test "shift_left Nativeint arch32" =
    test
      ~op:I.Nativeint.shift_left
      ~expected_op:I.Nativeint.Naive.shift_left
      ~name:"Nativeint.shift_left";
    [%expect {| |}];
    ()
  ;;

  let%expect_test "shift_right Nativeint arch32" =
    test
      ~op:I.Nativeint.shift_right
      ~expected_op:I.Nativeint.Naive.shift_right
      ~name:"Nativeint.shift_right";
    [%expect {| |}];
    ()
  ;;

  let%expect_test "shift_right_logical Nativeint arch32" =
    test
      ~op:I.Nativeint.shift_right_logical
      ~expected_op:I.Nativeint.Naive.shift_right_logical
      ~name:"Nativeint.shift_right_logical";
    [%expect {| |}];
    ()
  ;;
end
